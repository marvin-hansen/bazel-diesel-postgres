load("@rules_rust//crate_universe:defs.bzl", "crate", "crates_vendor")

crates_vendor(
    name = "crates_vendor",
    annotations = {
        "pq-sys": [
            crate.annotation(
                build_script_env = {
                    "PQ_LIB_STATIC": "1",
                },
                rustc_flags = [
                    "-L",
                    "$(BINDIR)/@@//alias:libpq",
                ],
                deps = ["@@//alias:libpq"],
            ),
        ],
    },
    mode = "remote",
    packages = {
        "diesel": crate.spec(
            default_features = False,
            features = [
                "postgres",
                "r2d2",
            ],
            package = "diesel",
            version = "2.2.2",
        ),
        "diesel_migrations": crate.spec(
            default_features = False,
            features = ["postgres"],
            package = "diesel_migrations",
            version = "2.2.0",
        ),
    },
    repository_name = "deps_vendored",
    tags = ["manual"],
)
